<html>
<head>
  	<title>MATRIX Lista de Pedidos x Internet Pendientes de Despacho</title>
  	<!-- UTF-8 is the recommended encoding for your pages -->
 
    <title>Zapatec DHTML Calendar</title>

<!-- Loading Theme file(s) -->
    <link rel="stylesheet" href="../../zpcal/themes/winter.css" />

<!-- Loading Calendar JavaScript files -->
    <script type="text/javascript" src="../../zpcal/src/utils.js"></script>
    <script type="text/javascript" src="../../zpcal/src/calendar.js"></script>
    <script type="text/javascript" src="../../zpcal/src/calendar-setup.js"></script>
    <!-- Loading language definition file -->
    <script type="text/javascript" src="../../zpcal/lang/calendar-sp.js"></script>
    <style type="text/css">
    	//body{background:white url(portal.gif) transparent center no-repeat scroll;}
    	#tipo1{color:#000066;background:#FFFFFF;font-size:7pt;font-family:Tahoma;font-weight:bold;}
    	#tipo2{color:#000066;background:#FFFFFF;font-size:7pt;font-family:Tahoma;font-weight:bold;}
    	.tipo3{color:#000066;background:#FFFFFF;font-size:7pt;font-family:Tahoma;font-weight:bold;text-align:left;}
    	.tipo3A{color:#000066;background:#FFFFFF;font-size:7pt;font-family:Tahoma;font-weight:bold;text-align:left;}
    	.tipo4{color:#000066;background:#dddddd;font-size:6pt;font-family:Tahoma;font-weight:bold;text-align:center;}
    	.tipo4A(color:#000066;background:#99CCFF;font-size:6pt;font-family:Tahoma;font-weight:bold;text-align:center;}
    	#tipo5{color:#000066;background:#FFFFFF;font-size:10pt;font-family:Tahoma;font-weight:bold;}
    	.tipo6{color:#000066;background:#FFFFFF;font-size:10pt;font-family:Tahoma;font-weight:bold;text-align:center;}
    	#tipo7{color:#FFFFFF;background:#000066;font-size:12pt;font-family:Tahoma;font-weight:bold;width:30em;}
    	#tipo8{color:#99CCFF;background:#000066;font-size:6pt;font-family:Tahoma;font-weight:bold;}
    	#tipo9{color:#660000;background:#dddddd;font-size:8pt;font-family:Tahoma;font-weight:bold;text-align:center;}
    	#tipo10{color:#FFFFFF;background:#000066;font-size:10pt;font-family:Tahoma;font-weight:bold;text-align:center;}
    	#tipo11{color:#000066;background:#999999;font-size:7pt;font-family:Tahoma;font-weight:bold;text-align:center;}
    	#tipo12{color:#000066;background:#FFFFFF;font-size:7pt;font-family:Tahoma;font-weight:bold;text-align:left;}
    	#tipo13{color:#000066;background:#99CCFF;font-size:7pt;font-family:Tahoma;font-weight:bold;text-align:left;}
    	#tipo14{color:#FFFFFF;background:#000066;font-size:14pt;font-family:Tahoma;font-weight:bold;text-align:center;}
    	#tipo15{color:#000066;background:#FFFFFF;font-size:7pt;font-family:Tahoma;font-weight:bold;text-align:center;}
    	#tipo16{color:#000066;background:#99CCFF;font-size:7pt;font-family:Tahoma;font-weight:bold;text-align:center;}
    	#tipo17{color:#000066;background:#CC99FF;font-size:10pt;font-family:Tahoma;font-weight:bold;text-align:center;}
    	#tipo18{color:#000066;background:#DDDDDD;font-size:7pt;font-family:Tahoma;font-weight:bold;text-align:center;}
    	#tipo19{color:#000066;background:#FFFFFF;font-size:7pt;font-family:Tahoma;font-weight:bold;text-align:right;}
    	#tipo20{color:#000066;background:#FFFFFF;font-size:7pt;font-family:Tahoma;font-weight:bold;text-align:center;}
    	#tipo21{color:#000066;background:#DDDDDD;font-size:9pt;font-family:Tahoma;font-weight:bold;text-align:center;}

    	#tipo00{color:#000066;background:#FFFFFF;font-size:7pt;font-family:Tahoma;font-weight:bold;table-layout:fixed;text-align:center;}
    	#tipoTCK{color:#000066;background:#999999;font-size:7.2pt;font-family:Tahoma;font-weight:bold;width:8em;text-align:center;height:4.5em;}
    	#tipoT00{color:#000066;background:#999999;font-size:7.2pt;font-family:Tahoma;font-weight:bold;width:8em;text-align:center;height:4.5em;}
    	#tipoT01{color:#000066;background:#999999;font-size:7.2pt;font-family:Tahoma;font-weight:bold;width:8em;text-align:center;height:4.5em;}
    	#tipoT02{color:#000066;background:#999999;font-size:7pt;font-family:Tahoma;font-weight:bold;width:1.5em;text-align:center;height:4.5em;}
    	#tipoT03{color:#000066;background:#999999;font-size:7pt;font-family:Tahoma;font-weight:bold;width:8em;text-align:center;height:4.5em;}
    	#tipoT04{color:#000066;background:#999999;font-size:7pt;font-family:Tahoma;font-weight:bold;width:15em;text-align:center;height:4.5em;}
    	#tipoT05{color:#000066;background:#999999;font-size:7pt;font-family:Tahoma;font-weight:bold;width:10em;text-align:center;height:4.5em;}
    	#tipoT06{color:#000066;background:#999999;font-size:7pt;font-family:Tahoma;font-weight:bold;width:1.5em;text-align:center;height:4.5em;}
    	#tipoT07{color:#000066;background:#999999;font-size:7pt;font-family:Tahoma;font-weight:bold;width:3.0em;text-align:center;height:4.5em;}
    	#tipoT08{color:#000066;background:#999999;font-size:7pt;font-family:Tahoma;font-weight:bold;width:15em;text-align:center;height:4.5em;}
    	#tipoT09{color:#000066;background:#999999;font-size:7pt;font-family:Tahoma;font-weight:bold;width:20em;text-align:center;height:4.5em;}
    	#tipoT10{color:#000066;background:#999999;font-size:7pt;font-family:Tahoma;font-weight:bold;width:15em;text-align:center;height:4.5em;}
    	#tipoT11{color:#000066;background:#999999;font-size:7pt;font-family:Tahoma;font-weight:bold;width:1.5em;text-align:center;height:4.5em;}
    	#tipoT12{color:#000066;background:#999999;font-size:7pt;font-family:Tahoma;font-weight:bold;width:1.5em;text-align:center;height:4.5em;}
    	#tipoT13{color:#000066;background:#999999;font-size:7pt;font-family:Tahoma;font-weight:bold;width:1.5em;text-align:center;height:4.5em;}
    	#tipoT14{color:#000066;background:#999999;font-size:7pt;font-family:Tahoma;font-weight:bold;width:1.5em;text-align:center;height:4.5em;}
    	#tipoT15{color:#000066;background:#999999;font-size:7pt;font-family:Tahoma;font-weight:bold;width:15em;text-align:center;height:4.5em;}
    	#tipoT16{color:#000066;background:#999999;font-size:7pt;font-family:Tahoma;font-weight:bold;width:20em;text-align:center;height:4.5em;}
    	#tipoT17{color:#000066;background:#999999;font-size:7pt;font-family:Tahoma;font-weight:bold;width:20em;text-align:center;height:4.5em;}
    	
    	#tipoD00{color:#000066;background:#99CCFF;font-size:6pt;font-family:Tahoma;font-weight:bold;width:8em;text-align:center;height:4.5em;}
    	#tipoDCK{color:#000066;background:#99CCFF;font-size:7pt;font-family:Tahoma;font-weight:bold;width:10em;text-align:center;height:4.5em;}
    	#tipoD01{color:#000066;background:#99CCFF;font-size:7pt;font-family:Tahoma;font-weight:bold;width:10em;text-align:center;height:4.5em;}
    	#tipoDE01{color:#000066;background:#CC99FF;font-size:7.2pt;font-family:Tahoma;font-weight:bold;width:20em;text-align:center;height:3em;}
    	#tipoD02{color:#000066;background:#99CCFF;font-size:7pt;font-family:Tahoma;font-weight:bold;width:3em;text-align:center;height:4.5em;}
    	#tipoD03{color:#000066;background:#99CCFF;font-size:7pt;font-family:Tahoma;font-weight:bold;width:8em;text-align:center;height:4.5em;}
    	#tipoDA03{color:#000066;background:#CC99FF;font-size:7pt;font-family:Tahoma;font-weight:bold;width:3em;text-align:center;height:4.5em;}
    	#tipoDB03{color:#000066;background:#FFCC66;font-size:7pt;font-family:Tahoma;font-weight:bold;width:3em;text-align:center;height:4.5em;}
    	#tipoDC03{color:#000066;background:#FF0000;font-size:7pt;font-family:Tahoma;font-weight:bold;width:3em;text-align:center;height:4.5em;}
    	#tipoD04{color:#000066;background:#99CCFF;font-size:7pt;font-family:Tahoma;font-weight:bold;width:15em;text-align:center;height:4.5em;}
    	#tipoD05{color:#000066;background:#99CCFF;font-size:7pt;font-family:Tahoma;font-weight:bold;width:20em;text-align:left;height:4.5em;}
    	#tipoD06{color:#000066;background:#99CCFF;font-size:7pt;font-family:Tahoma;font-weight:bold;width:3em;text-align:center;height:4.5em;}
    	#tipoD07{color:#000066;background:#99CCFF;font-size:7pt;font-family:Tahoma;font-weight:bold;width:3em;text-align:center;height:4.5em;}
    	#tipoD08{color:#000066;background:#99CCFF;font-size:7pt;font-family:Tahoma;font-weight:bold;width:20em;text-align:left;height:4.5em;}
    	#tipoD09{color:#000066;background:#99CCFF;font-size:7pt;font-family:Tahoma;font-weight:bold;width:20em;text-align:left;height:4.5em;}
    	#tipoD10{color:#000066;background:#99CCFF;font-size:7pt;font-family:Tahoma;font-weight:bold;width:20em;text-align:left;height:4.5em;}
    	#tipoD11{color:#000066;background:#99CCFF;font-size:7pt;font-family:Tahoma;font-weight:bold;width:3em;text-align:center;height:4.5em;}
    	#tipoD12{color:#000066;background:#99CCFF;font-size:7pt;font-family:Tahoma;font-weight:bold;width:3em;text-align:center;height:4.5em;}
    	#tipoD13{color:#000066;background:#99CCFF;font-size:7pt;font-family:Tahoma;font-weight:bold;width:3em;text-align:center;height:4.5em;}
    	#tipoD14{color:#000066;background:#99CCFF;font-size:7pt;font-family:Tahoma;font-weight:bold;width:3em;text-align:center;height:4.5em;}
    	#tipoD15{color:#000066;background:#99CCFF;font-size:7pt;font-family:Tahoma;font-weight:bold;width:20em;text-align:left;height:4.5em;}
    	#tipoD16{color:#000066;background:#99CCFF;font-size:7pt;font-family:Tahoma;font-weight:bold;width:30em;text-align:left;height:4.5em;}
    	#tipoD17{color:#000066;background:#99CCFF;font-size:7pt;font-family:Tahoma;font-weight:bold;width:20em;text-align:left;height:4.5em;}
    	#tipoA03{color:#000066;background:#CC99FF;font-size:7pt;font-family:Tahoma;font-weight:bold;width:8em;text-align:center;height:4.5em;}
    	
    	#tipoL00{color:#000066;background:#DDDDDD;font-size:6pt;font-family:Tahoma;font-weight:bold;width:8em;text-align:center;height:4.5em;}
    	#tipoLCK{color:#000066;background:#DDDDDD;font-size:7pt;font-family:Tahoma;font-weight:bold;width:10em;text-align:center;height:4.5em;}
    	#tipoL01{color:#000066;background:#DDDDDD;font-size:7pt;font-family:Tahoma;font-weight:bold;width:10em;text-align:center;height:4.5em;}
    	#tipoL001{color:#000066;background:#999999;font-size:7pt;font-family:Tahoma;font-weight:bold;width:10em;text-align:center;height:1em;}
    	#tipoLE01{color:#000066;background:#CC99FF;font-size:7.2pt;font-family:Tahoma;font-weight:bold;width:20em;text-align:center;height:3em;}
    	#tipoL02{color:#000066;background:#DDDDDD;font-size:7pt;font-family:Tahoma;font-weight:bold;width:3em;text-align:center;height:4.5em;}
    	#tipoL03{color:#000066;background:#DDDDDD;font-size:7pt;font-family:Tahoma;font-weight:bold;width:8em;text-align:center;height:4.5em;}
    	#tipoLA03{color:#000066;background:#CC99FF;font-size:7pt;font-family:Tahoma;font-weight:bold;width:3em;text-align:center;height:4.5em;}
    	#tipoLB03{color:#000066;background:#FFCC66;font-size:7pt;font-family:Tahoma;font-weight:bold;width:3em;text-align:center;height:4.5em;}
    	#tipoLC03{color:#000066;background:#FF0000;font-size:7pt;font-family:Tahoma;font-weight:bold;width:3em;text-align:center;height:4.5em;}
    	#tipoL04{color:#000066;background:#DDDDDD;font-size:7pt;font-family:Tahoma;font-weight:bold;width:15em;text-align:center;height:4.5em;}
    	#tipoL05{color:#000066;background:#DDDDDD;font-size:7pt;font-family:Tahoma;font-weight:bold;width:20em;text-align:left;height:4.5em;}
    	#tipoL06{color:#000066;background:#DDDDDD;font-size:7pt;font-family:Tahoma;font-weight:bold;width:3em;text-align:center;height:4.5em;}
    	#tipoL07{color:#000066;background:#DDDDDD;font-size:7pt;font-family:Tahoma;font-weight:bold;width:3em;text-align:center;height:4.5em;}
    	#tipoL08{color:#000066;background:#DDDDDD;font-size:7pt;font-family:Tahoma;font-weight:bold;width:20em;text-align:left;height:4.5em;}
    	#tipoL09{color:#000066;background:#DDDDDD;font-size:7pt;font-family:Tahoma;font-weight:bold;width:20em;text-align:left;height:4.5em;}
    	#tipoL10{color:#000066;background:#DDDDDD;font-size:7pt;font-family:Tahoma;font-weight:bold;width:20em;text-align:left;height:4.5em;}
    	#tipoL11{color:#000066;background:#DDDDDD;font-size:7pt;font-family:Tahoma;font-weight:bold;width:3em;text-align:center;height:4.5em;}
    	#tipoL12{color:#000066;background:#DDDDDD;font-size:7pt;font-family:Tahoma;font-weight:bold;width:3em;text-align:center;height:4.5em;}
    	#tipoL13{color:#000066;background:#DDDDDD;font-size:7pt;font-family:Tahoma;font-weight:bold;width:3em;text-align:center;height:4.5em;}
    	#tipoL14{color:#000066;background:#DDDDDD;font-size:7pt;font-family:Tahoma;font-weight:bold;width:3em;text-align:center;height:4.5em;}
    	#tipoL15{color:#000066;background:#DDDDDD;font-size:7pt;font-family:Tahoma;font-weight:bold;width:20em;text-align:left;height:4.5em;}
    	#tipoL16{color:#000066;background:#DDDDDD;font-size:7pt;font-family:Tahoma;font-weight:bold;width:30em;text-align:left;height:4.5em;}
    	#tipoL17{color:#000066;background:#DDDDDD;font-size:7pt;font-family:Tahoma;font-weight:bold;width:20em;text-align:left;height:4.5em;}
    	
    </style>
</head>
<body onload=ira() BGCOLOR="FFFFFF" oncontextmenu = "return true" onselectstart = "return true" ondragstart = "return true">
<BODY TEXT="#000066">
<script type="text/javascript">
<!--
	function enter()
	{
		document.forms.ListaI.submit();
	}
	function ejecutar(path)
	{
		window.open(path,'','fullscreen=1,status=0,menubar=0,toolbar =0,directories =0,resizable=0,scrollbars =1,titlebar=0');
	}
	function teclado()  
	{ 
		if ((event.keyCode < 48 || event.keyCode > 57  || event.keyCode == 13) & event.keyCode != 46) event.returnValue = false;
	}
	function teclado1()  
	{ 
		if ((event.keyCode < 48 || event.keyCode > 57 ) & event.keyCode != 46 & event.keyCode != 13)  event.returnValue = false;
	}
	function teclado2()  
	{ 
		if ((event.keyCode < 48 || event.keyCode > 57 ) & (event.keyCode < 65 || event.keyCode > 90 ) & (event.keyCode < 97 || event.keyCode > 122 ) & event.keyCode != 13) event.returnValue = false;
	}
	function teclado3()  
	{ 
		if ((event.keyCode < 48 || event.keyCode > 57 ) & (event.keyCode < 65 || event.keyCode > 90 ) & (event.keyCode < 97 || event.keyCode > 122 ) & event.keyCode != 13 & event.keyCode != 45) event.returnValue = false;
	}

//-->
</script>
<?php
include_once("conex.php");
/**********************************************************************************************************************  
	   PROGRAMA : ListaI.php
	   Fecha de Liberación : 2008-10-10
	   Autor : Ing. Pedro Ortiz Tamayo
	   Version Actual : 2008-10-10
	   
	   OBJETIVO GENERAL :Este programa ofrece al usuario una interface gráfica que permite visualizar de forma matricial
	   los pedidos hechos x Internet que estan pendientes de despacho.
	   
	   REGISTRO DE MODIFICACIONES :
	   
	   .2008-10-10
	   		Release de Versión Beta.
	   		
***********************************************************************************************************************/

session_start();
if(!isset($_SESSION['user']))
	echo "error";
else
{
	$key = substr($user,2,strlen($user));
	echo "<form name='ListaI' action='ListaI.php' method=post>";
	echo "<meta http-equiv='refresh' content='60;url=ListaI.php?empresa=farstore'>";
	

	

	echo "<center><input type='HIDDEN' name= 'empresa' value='".$empresa."'>";
	if(isset($num) and $num > 0)
	{
		for ($i=0;$i<$num;$i++)
		{
			if(isset($CHK_I[$i]))
			{
				$query =  " update ".$empresa."_000086 set Menest = 'I' ";
				$query .=  "  where Mennum=".$data[$i];
				$err1 = mysql_query($query,$conex) or die("ERROR ACTUALIZANDO ENCABEZADO DE PEDIDOS : ".mysql_errno().":".mysql_error());
				$query =  " update ".$empresa."_000087 set Mdeest = 'I' ";
				$query .=  "  where Mdenum=".$data[$i];
				$err1 = mysql_query($query,$conex) or die("ERROR ACTUALIZANDO DETALLE DE PEDIDOS : ".mysql_errno().":".mysql_error());
			}
			elseif(isset($CHK_V[$i]))
				{
					$query =  " update ".$empresa."_000086 set Menest = 'V' ";
					$query .=  "  where Mennum=".$data[$i];
					$err1 = mysql_query($query,$conex) or die("ERROR ACTUALIZANDO ENCABEZADO DE PEDIDOS : ".mysql_errno().":".mysql_error());
					$query =  " update ".$empresa."_000087 set Mdeest = 'V' ";
					$query .=  "  where Mdenum=".$data[$i];
					$err1 = mysql_query($query,$conex) or die("ERROR ACTUALIZANDO DETALLE DE PEDIDOS : ".mysql_errno().":".mysql_error());
				}
				
		}
	}
	$data=array();
	echo "<table border=0 align=center>";
	echo "<tr><td align=center><IMG SRC='/matrix/images/medical/POS/logo_".$empresa.".png'></td></tr>";
	echo "<tr><td align=center id=tipo20>LAS AMERICAS FARMASTORE</td></tr>";
	echo "<tr><td align=center id=tipo21>LISTA DE PEDIDOS X INTERNET PENDIENTES DE DESPACHO</td></tr>";
	echo "<tr><td align=left id=tipo20>Ver. 2008-10-10</td></tr>";
	echo "<tr><td align=center><INPUT type=button value='Cerrar Ventana' OnClick='javascript:window.close();'</td></tr></table>";
	echo "<table border=0 align=center id=tipo00>";
	echo "<tr><td id=tipoT01>CONFIRMAR</td><td id=tipoT01>INACTIVAR</td><td id=tipoT01>VENDER</td>";
	echo "<td id=tipoT01>NRO. PEDIDO</td><td id=tipoT01>FECHA</td><td id=tipoT00>HORA</td><td id=tipoT04>TELEFONO</td><td id=tipoT17>NOMBRE</td><td id=tipoT17>DIRECCION</td><td id=tipoT17>E-mail</td><td id=tipoT03>ESTADO</td></tr>";
     //                0                             1                                 2       3       4        5      6       7   
	$query  = "SELECT Mennum, ".$empresa."_000086.Fecha_data, ".$empresa."_000086.Hora_data, Mentel, Mclnom, Mcldir, Mcleme, Menest FROM ".$empresa."_000086, ".$empresa."_000085 ";
	$query .= " where Menest IN ('A','C') ";
	$query .= "   and Mentel = Mcltel ";
	$query .= "   order by  ".$empresa."_000086.Fecha_data, ".$empresa."_000086.Hora_data ";
    $err = mysql_query($query,$conex) or die(mysql_errno().":".mysql_error());
    $num = mysql_num_rows($err);
	echo "<input type='HIDDEN' name= 'num' value='".$num."'>";
	for ($i=0;$i<$num;$i++)
	{
		$row = mysql_fetch_array($err);
		$data[$i] = $row[0]; 
		echo "<input type='HIDDEN' name= 'data[".$i."]' value='".$data[$i]."'>";
		if($i % 2 == 0)
			$tipo="tipoD";
		else
			$tipo="tipoL";
		echo "<tr>";
		echo "<td id=".$tipo."CK><input type='checkbox' name='CHK_C[".$i."]'  OnClick='ejecutar(".chr(34)."/MATRIX/pos/Procesos/OrderOnline.php?empresa=".$empresa."&ok=96&wnped=".$row[0]."&wtel=".$row[3]."&wfec=".$row[1]."&whor=".$row[2].chr(34).")'></td>";
		echo "<td id=".$tipo."CK><input type='checkbox' name='CHK_I[".$i."]' onclick='enter()'></td>";
		echo "<td id=".$tipo."CK><input type='checkbox' name='CHK_V[".$i."]' onclick='enter()'></td>";
		echo "<td id=".$tipo."01>".$row[0]."</td><td id=".$tipo."01>".$row[1]."</td><td id=".$tipo."01>".$row[2]."</td><td id=".$tipo."04>".$row[3]."</td><td id=".$tipo."17>".$row[4]."</td><td id=".$tipo."17>".$row[5]."</td><td id=".$tipo."17>".$row[6]."</td>";
		if($row[7] == "C")
			$tipo="tipoA";
		echo "<td id=".$tipo."03>".$row[7]."</td>";
		echo "</tr>";
	}
	echo "<tr><td align=center colspan=11 id=tipo21>NUMERO TOTAL DE PEDIDOS : ".$num."</td></tr>";
	echo "</table>";

	}
?>
</body>
</html>
